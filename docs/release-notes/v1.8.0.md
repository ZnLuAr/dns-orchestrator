# v1.8.0 发行说明

## 概述

v1.8.0 聚焦于用户体验和前端架构优化。本版本新增 DNS 记录向导模式，让小白用户也能轻松配置邮件等复杂场景；同时完成前端存储层的类型安全重构，并大幅提升移动端适配体验。

## 新增功能

### DNS 记录向导模式

全新引导式配置体验，降低 DNS 配置门槛：

**四大场景支持**：
- **网站配置**：快速配置域名指向服务器
- **邮件配置**：主流邮件服务商预设一键应用
- **子域名配置**：轻松创建子域名记录
- **域名验证**：支持 TXT/CNAME 验证记录

**邮件服务商预设**：
- Gmail / Google Workspace
- Microsoft 365
- 阿里云企业邮箱
- 腾讯企业邮箱
- 支持批量创建 MX + SPF + DKIM 记录

**使用方式**：
- DNS 记录页工具栏新增"向导模式"入口
- 与现有"高级模式"并列，灵活切换

### 标签选择下拉框

优化标签管理效率：

- **新增 TagInputCombobox 组件**：输入框 + 下拉选择二合一
- **复用已有标签**：从现有标签列表快速选择，减少重复输入
- **搜索过滤**：快速定位目标标签
- **应用场景**：批量操作栏、元数据编辑器均已适配

### 收藏域名页面增强

- 新增标签筛选功能
- 优化卡片显示效果
- 标签数量限制和溢出显示

## 重大重构

### 前端存储层统一

完成 localStorage 访问的类型安全重构：

**核心变更**：
- 新增 `IStorage` 接口抽象存储层
- 引入类型安全的存储键映射（`STORAGE_KEYS`）
- 统一默认值配置，避免硬编码

**自动迁移**：
- 旧版存储键自动迁移至新格式
- 迁移完成后移除遗留键值
- 完全向后兼容，用户无感知

**受影响模块**：
- 语言设置（i18n）
- 主题设置
- 域名缓存
- 最近访问域名
- 更新检查状态

### 域名列表组件重构

拆分提取可复用组件，提升代码质量：

- **DomainAccountGroup**：账户分组容器
- **DomainItem**：域名条目组件
  - `DomainItemDesktop`：桌面端布局
  - `DomainItemMobile`：移动端布局
- **useFilteredDomains Hook**：域名筛选逻辑

## 移动端适配增强

大幅优化移动端交互体验：

**批量操作栏**：
- 图标按钮 + Tooltip 提示
- 适配小屏幕布局

**分页组件**：
- 移动端专属页面大小选择器
- 简化页码选择器
- 响应式文本隐藏

**工具栏**：
- 部分按钮转换为图标模式
- 添加 Tooltip 提示

**更新检查**：
- 基于真实平台判断，而非屏幕宽度

## 技术改进

### 性能优化

- 使用 `useMemo` 缓存已使用标签列表
- 关闭标签下拉菜单时自动清空搜索查询
- 域名缓存格式兼容性检查改进

### 代码质量

- Tailwind CSS 类顺序标准化
- 移除冗余条件渲染
- 添加无障碍标签支持
- 可选链访问修复（`metadata.color`）

### 依赖更新

| 包名 | 版本 |
|------|------|
| @tauri-apps/plugin-dialog | 2.5.0 |
| @tauri-apps/plugin-fs | 2.4.5 |
| i18next | 25.7.4 |
| react-i18next | 16.5.1 |
| react-router-dom | 7.12.0 |
| @biomejs/biome | 2.3.11 |
| vite | 7.3.1 |
| use-debounce | 10.1.0 |
| @types/node | 25.0.5 |
| pnpm | 10.28.0 |

## 多语言支持

新增翻译项：
- DNS 向导模式相关（场景选择、预设名称、步骤提示）
- 标签选择器相关（搜索已有标签、选择已有标签、无匹配标签）
- 分页组件相关（"Page {{page}}"）
- 移动端按钮 Tooltip

## 技术统计

- **新增文件**：约 18 个
  - DNS 向导组件：8 个
  - 域名列表组件：6 个
  - 存储服务：4 个
- **修改文件**：约 24 个
- **新增代码**：+2,819 行
- **删除代码**：-688 行
- **净增加**：+2,131 行

## 升级说明

从 v1.7.x 升级到 v1.8.0 无需特殊操作：

1. **存储迁移自动完成**：首次启动时会自动迁移本地存储数据
2. **功能兼容**：所有现有功能保持不变
3. **无破坏性变更**：API 和数据格式均向后兼容

## 已知问题

- DNS 向导模式暂不支持所有记录类型（目前覆盖常用场景）
- 邮件预设仅包含主流服务商，后续版本将扩展

## 致谢

感谢 @AptS-1547 和 @AptS-1548 的贡献。

## 下一步计划

- 扩展 DNS 向导支持更多场景
- 添加更多邮件服务商预设
- 域名元数据导入/导出
- 工具箱功能扩展

---

**完整变更日志**：[v1.7.0...v1.8.0](https://github.com/AptS-1547/dns-orchestrator/compare/v1.7.0...v1.8.0)
