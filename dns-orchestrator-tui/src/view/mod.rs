//！┌─────────────────────────────────────────────────────────────────────────────┐
//！│                              主循环 (app.rs)                               │
//！│                                                                            │
//！│  ┌────────────────────────────── UI 层 ───────────────────────────────┐   │
//！│  │                                                                     │   │
//！│  │   ┌─────────┐          ┌───────────┐          ┌──────────┐         │   │
//！│  │   │  Event  │ ───────▶ │  Message  │ ───────▶ │  Update  │         │   │
//！│  │   │   层    │   翻译    │    层     │   消费    │    层    │         │   │
//！│  │   └─────────┘          │           │          └────┬─────┘         │   │
//！│  │        ▲               │ AppMessage│               │ 修改          │   │
//！│  │        │               │ ModalMsg  │               ▼               │   │
//！│  │   ┌─────────┐          │ ContentMsg│          ┌──────────┐         │   │
//！│  │   │  View   │          │ NavMsg    │   ┌───── │  Model   │         │   │
//！│  │   │   层    │          └───────────┘   │      │    层    │         │   │
//！│  │   └────┬────┘ ◀──────── 读取 ──────────┘      └────┬─────┘         │   │
//！│  │        │                                           │               │   │
//！│  └────────│───────────────────────────────────────────│───────────────┘   │
//！│           │                                           │ 异步调用          │
//！│           ▼                                           ▼                   │
//！│      ┌─────────┐                                ┌──────────┐              │
//！│      │  终端   │                                │ Backend  │              │
//！│      │ (Util)  │                                │    层    │              │
//！│      └─────────┘                                └────┬─────┘              │
//！│                                                      │                    │
//！│                                                      ▼                    │
//！│                                           ┌───────────────────┐           │
//！│                                           │dns-orchestrator-  │           │
//！│                                           │      core         │           │
//！│                                           └───────────────────┘           │
//！└─────────────────────────────────────────────────────────────────────────────┘

//!
//! src/view/mod.rs
//! View 层：UI 渲染
//!
//! View 层是纯函数，只负责根据 Model 状态渲染 UI。
//! 不包含任何状态修改或业务逻辑。
//!
//!
//! 有模块结构：
//!     src/view/mod.rs
//!         pub mod components;     // UI 组件（导航栏、状态栏等）
//!         pub mod layout;         // 主布局（垂直三分 + 水平二分）
//!         pub mod pages;          // 各页面渲染
//!         pub mod theme;          // 主题和样式定义
//!
//!
//! ═══════════════════════════════════════════════════════════════════════════
//! 一、渲染入口
//! ═══════════════════════════════════════════════════════════════════════════
//!
//!     在 src/view/mod.rs 中定义渲染入口：
//!
//!         pub fn render(app: &App, frame: &mut Frame) {
//!             //         ↑↑↑↑  不可变引用，只读取，不修改
//!             layout::render(app, frame);
//!         }
//!
//!     在 src/app.rs 主循环中调用：
//!         terminal.draw(|frame| {
//!             view::render(&app, frame);      // 每次循环都完整重绘
//!         })?;
//!
//!
//! ═══════════════════════════════════════════════════════════════════════════
//! 二、布局系统
//! ═══════════════════════════════════════════════════════════════════════════
//!
//!     在 src/view/layout.rs 中定义主布局：
//!
//!         步骤 1：垂直三分（标题栏 + 主内容 + 状态栏）
//!             Layout::default()
//!                 .direction(Direction::Vertical)
//!                 .constraints([
//!                     Constraint::Length(1),      // 标题栏：固定 1 行
//!                     Constraint::Min(1),         // 主内容：占剩余空间
//!                     Constraint::Length(1),      // 状态栏：固定 1 行
//!                 ])
//!
//!         步骤 2：水平二分（导航 + 内容）
//!             Layout::default()
//!                 .direction(Direction::Horizontal)
//!                 .constraints([
//!                     Constraint::Percentage(20),     // 左侧导航：20%
//!                     Constraint::Percentage(80),     // 右侧内容：80%
//!                 ])
//!
//!         步骤 3：渲染各区域
//!             - render_title_bar()：渲染顶部标题栏
//!             - components::navigation::render()：渲染左侧导航
//!             - render_page_content()：根据 current_page 渲染内容
//!             - components::statusbar::render()：渲染底部状态栏
//!
//!
//! ═══════════════════════════════════════════════════════════════════════════
//! 三、组件渲染
//! ═══════════════════════════════════════════════════════════════════════════
//!
//!     导航栏（./components/navigation.rs）：
//!         - 根据 app.focus.is_navigation() 设置边框颜色
//!         - 遍历 app.navigation.items，构建 ListItem 列表
//!         - 根据 app.navigation.selected 高亮当前选中项
//!         - 使用 ListState 和 render_stateful_widget 渲染
//!
//!     状态栏（./components/statusbar.rs）：
//!         - 根据当前焦点和页面动态生成快捷键提示
//!         - 焦点在导航栏时显示：↑↓ 导航、Enter 进入
//!         - 焦点在内容区时根据不同页面显示不同快捷键
//!         - 如果有 app.status_message，显示在右侧
//!
//!     弹窗（./components/modal.rs）：
//!         - 检查 app.modal.active 是否有弹窗
//!         - 根据弹窗类型分发到具体的渲染函数：
//!             render_add_account()    渲染添加账号弹窗
//!             render_dns_lookup()     渲染 DNS 查询工具
//!             render_help()           渲染帮助弹窗
//!             ... 其他弹窗
//!         - 弹窗居中显示，使用 Clear widget 清除背景
//!         - 根据 focus 字段高亮当前输入字段
//!
//!
//! ═══════════════════════════════════════════════════════════════════════════
//! 四、样式系统
//! ═══════════════════════════════════════════════════════════════════════════
//!
//!     在 src/view/theme.rs 中定义所有样式：
//!
//!         Styles::border()            // 普通边框（灰色）
//!         Styles::border_focused()    // 焦点边框（蓝色）
//!         Styles::selected()          // 选中项（蓝色背景 + 加粗）
//!         Styles::statusbar()         // 状态栏（蓝色背景）
//!         Styles::hint_key()          // 快捷键（黄色 + 加粗）
//!
//!     样式构建：
//!         Style::default()
//!             .fg(Color::Rgb(r, g, b))        // 前景色（文字）
//!             .bg(Color::Rgb(r, g, b))        // 背景色
//!             .add_modifier(Modifier::BOLD)   // 修饰符（加粗等）
//!
//!
//! ═══════════════════════════════════════════════════════════════════════════
//! 五、设计原则
//! ═══════════════════════════════════════════════════════════════════════════
//!
//!     1. 纯函数：View 层只读取 app 状态（&App），不修改
//!     2. 完整重绘：每次渲染都是完整的，不是增量更新
//!     3. 分层组织：layout → components/pages → ratatui widgets
//!     4. 样式分离：所有颜色定义在 theme.rs，不硬编码
//!
//!
//! View 层渲染完成后，输出到终端屏幕。
//! 用户看到 UI 并进行操作，输入由 Event 层捕获。
//!     —— 回到 src/app.rs 主循环
//!

pub mod components;
pub mod layout;
pub mod pages;
pub mod theme;

use ratatui::Frame;

use crate::model::App;

/// 渲染整个应用界面
pub fn render(app: &App, frame: &mut Frame) {
    layout::render(app, frame);
}
